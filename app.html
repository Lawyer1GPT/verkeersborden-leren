<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Verkeersborden Leren - Lewandowski.ai</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            min-height: 100vh;
            padding: 10px;
            color: #e0e0e0;
            transition: all 0.3s;
        }

        body.light-theme {
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,255,0,0.1);
            text-align: center;
            border: 1px solid #00ff00;
        }

        body.light-theme header {
            background: white;
            border: 1px solid #e0e0e0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .logo {
            height: 80px;
            margin-bottom: 15px;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            background: #00dd00;
            transform: scale(1.05);
        }

        body.light-theme .theme-toggle {
            background: #1e3c72;
            color: white;
        }

        h1 {
            color: #00ff00;
            font-size: 24px;
            margin-bottom: 10px;
        }

        body.light-theme h1 {
            color: #1e3c72;
        }

        .subtitle {
            color: #888;
            font-size: 14px;
            margin-bottom: 15px;
        }

        body.light-theme .subtitle {
            color: #666;
        }

        .controls {
            background: #222;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,255,0,0.1);
            border: 1px solid #333;
        }

        body.light-theme .controls {
            background: white;
            border: 1px solid #e0e0e0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .search-box {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #333;
            border-radius: 10px;
            margin-bottom: 15px;
            transition: all 0.3s;
            background: #1a1a1a;
            color: #e0e0e0;
        }

        .search-box:focus {
            outline: none;
            border-color: #00ff00;
            box-shadow: 0 0 0 3px rgba(0, 255, 0, 0.2);
        }

        body.light-theme .search-box {
            background: white;
            color: #333;
            border: 2px solid #e0e0e0;
        }

        body.light-theme .search-box:focus {
            border-color: #1e3c72;
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1);
        }

        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .filter-btn {
            padding: 10px 20px;
            border: 2px solid #00ff00;
            background: #1a1a1a;
            color: #00ff00;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            font-weight: 600;
        }

        .filter-btn:hover {
            background: #00ff00;
            color: #000;
        }

        body.light-theme .filter-btn {
            border: 2px solid #1e3c72;
            background: white;
            color: #1e3c72;
        }

        body.light-theme .filter-btn:hover {
            background: #f0f0f0;
        }

        .filter-btn.active {
            background: #00ff00;
            color: #000;
        }

        .mode-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .mode-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            color: white;
        }

        .mode-btn.browse {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        }

        .mode-btn.quiz {
            background: linear-gradient(135deg, #d4418e 0%, #f093fb 100%);
        }

        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .mode-btn.active {
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
            transform: scale(1.05);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #333;
        }

        body.light-theme .stats {
            border-top: 2px solid #e0e0e0;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #00ff00;
        }

        body.light-theme .stat-number {
            color: #1e3c72;
        }

        .stat-label {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
        }

        body.light-theme .stat-label {
            color: #666;
        }

        /* Browse Mode */
        .signs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .sign-card {
            background: #222;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,255,0,0.1);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            border: 1px solid #333;
        }

        .sign-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,255,0,0.2);
            border-color: #00ff00;
        }

        body.light-theme .sign-card {
            background: white;
            border: 1px solid #e0e0e0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        body.light-theme .sign-card:hover {
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-color: #1e3c72;
        }

        .sign-image-container {
            width: 100%;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #1a1a1a;
            border-radius: 10px;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
            border: 1px solid #333;
        }

        body.light-theme .sign-image-container {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
        }
        }

        .sign-image {
            max-width: 90%;
            max-height: 180px;
            object-fit: contain;
        }

        .sign-code {
            display: inline-block;
            background: #1e3c72;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .sign-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .sign-category {
            font-size: 12px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .no-image {
            color: #999;
            font-size: 14px;
            text-align: center;
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            background: rgba(30, 60, 114, 0.98);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            line-height: 1.6;
            max-width: 350px;
            z-index: 1000;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip.show {
            opacity: 1;
        }

        .tooltip-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 8px;
            color: #fff;
        }

        .tooltip-description {
            margin-bottom: 10px;
        }

        .tooltip-article {
            font-size: 12px;
            font-style: italic;
            color: #cfd8e8;
            border-top: 1px solid rgba(255,255,255,0.2);
            padding-top: 8px;
            margin-top: 8px;
        }

        /* Quiz Mode */
        .quiz-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-width: 600px;
            margin: 0 auto;
        }

        .quiz-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }

        .quiz-counter {
            font-size: 16px;
            color: #1e3c72;
            font-weight: bold;
        }

        .quiz-score {
            font-size: 16px;
            color: #4caf50;
            font-weight: bold;
        }

        .quiz-question-text {
            font-size: 20px;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 20px;
            text-align: center;
            line-height: 1.5;
        }

        .quiz-image-container {
            width: 100%;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .quiz-image {
            max-width: 90%;
            max-height: 280px;
            object-fit: contain;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .quiz-option {
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            text-align: left;
            font-size: 16px;
        }

        .quiz-option:hover:not(.correct):not(.incorrect):not(.disabled) {
            border-color: #1e3c72;
            background: #f8f9ff;
        }

        .quiz-option.correct {
            border-color: #4caf50;
            background: #e8f5e9;
            color: #2e7d32;
        }

        .quiz-option.incorrect {
            border-color: #f44336;
            background: #ffebee;
            color: #c62828;
        }

        .quiz-option.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .quiz-navigation {
            display: flex;
            gap: 10px;
        }

        .quiz-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            color: white;
        }

        .quiz-btn.next {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        }

        .quiz-btn.restart {
            background: linear-gradient(135deg, #d4418e 0%, #f093fb 100%);
        }

        .quiz-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .quiz-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .quiz-result {
            text-align: center;
            padding: 30px;
        }

        .quiz-result h2 {
            color: #1e3c72;
            font-size: 28px;
            margin-bottom: 20px;
        }

        .quiz-result-score {
            font-size: 48px;
            font-weight: bold;
            color: #4caf50;
            margin-bottom: 20px;
        }

        .quiz-result-message {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 20px;
            }

            .signs-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }

            .sign-card {
                padding: 15px;
            }

            .sign-image-container {
                height: 150px;
            }

            .sign-image {
                max-height: 130px;
            }

            .sign-title {
                font-size: 14px;
            }

            .mode-buttons {
                grid-template-columns: 1fr;
            }

            .quiz-container {
                padding: 20px;
            }

            .quiz-image-container {
                height: 250px;
            }

            .tooltip {
                max-width: 280px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <button class="theme-toggle" onclick="toggleTheme()">‚òÄÔ∏è Light</button>
            <img src="logo.png" alt="Lewandowski.ai" class="logo">
            <h1>Verkeersborden Leren</h1>
            <div class="subtitle">Officiele RVV 1990 - Reglement verkeersregels en verkeerstekens</div>
        </header>

        <div class="controls">
            <input type="text" class="search-box" id="searchBox" placeholder="Zoek op code of omschrijving (bijv. A1, parkeren, snelheid)...">

            <div class="filter-buttons" id="filterButtons">
                <button class="filter-btn active" data-filter="all">Alle</button>
            </div>

            <div class="mode-buttons">
                <button class="mode-btn browse active" onclick="switchMode('browse')">Bladeren</button>
                <button class="mode-btn quiz" onclick="switchMode('quiz')">Quiz</button>
            </div>

            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalSigns">0</div>
                    <div class="stat-label">Totaal borden</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="visibleSigns">0</div>
                    <div class="stat-label">Zichtbaar</div>
                </div>
            </div>
        </div>

        <!-- Browse Mode -->
        <div id="browseMode">
            <div class="signs-grid" id="signsGrid"></div>
        </div>

        <!-- Quiz Mode -->
        <div id="quizMode" class="hidden">
            <div class="quiz-container">
                <div id="quizQuestion">
                    <div class="quiz-progress">
                        <div class="quiz-counter" id="quizCounter">Vraag 1/15</div>
                        <div class="quiz-score" id="quizScore">Score: 0/0</div>
                    </div>

                    <div class="quiz-question-text" id="questionText"></div>

                    <div class="quiz-image-container" id="quizImageContainer" style="display: none;">
                        <img id="quizImage" class="quiz-image" alt="Verkeersbord">
                    </div>

                    <div class="quiz-options" id="quizOptions"></div>

                    <div class="quiz-navigation">
                        <button class="quiz-btn next" id="quizNextBtn" onclick="nextQuestion()">Volgende</button>
                    </div>
                </div>

                <div id="quizResults" class="hidden quiz-result">
                    <h2>Quiz Voltooid!</h2>
                    <div class="quiz-result-score" id="finalScore">0/15</div>
                    <div class="quiz-result-message" id="resultMessage"></div>
                    <button class="quiz-btn restart" onclick="startQuiz()">Opnieuw Starten</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip"></div>

    <script>
        // Data storage
        let allSigns = [];
        let filteredSigns = [];
        let currentMode = 'browse';

        // Quiz state
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let quizScore = 0;
        let answeredCorrectly = false;

        // Tooltip
        const tooltip = document.getElementById('tooltip');

        // Enhanced sign descriptions with RVV context
        const signExplanations = {
            'A1': {
                description: 'Dit bord geeft de maximumsnelheid aan die op de weg geldt. De aangegeven snelheid mag niet worden overschreden.',
                article: 'RVV 1990, Artikel 20-21: Binnen bebouwde kom 50 km/u, buiten bebouwde kom 80 km/u (of zoals aangegeven)'
            },
            'B1': {
                description: 'Dit bord geeft aan dat u op een voorrangsweg rijdt. U heeft voorrang op kruispunten tot het volgende bord B2.',
                article: 'RVV 1990, Artikel 15: Voorrangsregels op kruispunten'
            },
            'B6': {
                description: 'Verleen voorrang aan bestuurders op de kruisende weg. U moet wachten als dat nodig is.',
                article: 'RVV 1990, Artikel 15: Voorrang verlenen aan bestuurders van rechts'
            },
            'B7': {
                description: 'Stop en verleen voorrang. U moet altijd volledig stoppen, ook als er geen verkeer is.',
                article: 'RVV 1990, Artikel 15: Absolute stopplicht op dit kruispunt'
            },
            'C1': {
                description: 'Deze weg is in beide richtingen gesloten voor alle voertuigen, ruiters en vee.',
                article: 'RVV 1990: Geslotenverklaring - toegang verboden'
            },
            'C12': {
                description: 'Deze weg is gesloten voor alle motorvoertuigen (auto\'s, motoren, bromfietsen).',
                article: 'RVV 1990: Motorvoertuigen mogen hier niet rijden'
            },
            'D1': {
                description: 'Rotonde - u moet verplicht de rijrichting volgen zoals aangegeven (tegen de klok in).',
                article: 'RVV 1990: Verplichte rijrichting op rotondes'
            },
            'E1': {
                description: 'Parkeren is hier verboden. Wel mag u stoppen om iemand in of uit te laten stappen of om te laden/lossen.',
                article: 'RVV 1990, Artikel 24: Parkeerverbod geldt niet voor onmiddellijk laden/lossen'
            },
            'E2': {
                description: 'Stilstaan is hier verboden. U mag hier noch parkeren, noch stoppen.',
                article: 'RVV 1990, Artikel 23: Stilstaanverbod - zelfs niet voor kort stoppen'
            },
            'E4': {
                description: 'Dit is een parkeergelegenheid waar u uw voertuig mag parkeren.',
                article: 'RVV 1990: Aangewezen parkeerplaats'
            },
            'G1': {
                description: 'Begin van een autosnelweg. Speciale regels gelden: minimumsnelheid 60 km/u, niet keren, niet achteruit rijden.',
                article: 'RVV 1990: Autosnelweg - maximaal 130 km/u (of zoals aangegeven)'
            },
            'G3': {
                description: 'Begin van een autoweg. Gesloten voor bromfietsen, snorfietsen, voetgangers en landbouwvoertuigen.',
                article: 'RVV 1990: Autoweg - maximaal 100 km/u buiten bebouwde kom'
            },
            'G5': {
                description: 'Begin van een erf. Voetgangers hebben voorrang, maximumsnelheid 15 km/u.',
                article: 'RVV 1990: Erf - stapvoets rijden, voetgangers mogen overal lopen'
            },
            'G11': {
                description: 'Verplicht fietspad. Fietsers en snorfietsers moeten dit pad gebruiken.',
                article: 'RVV 1990, Artikel 5: Verplicht gebruik fietspad voor fietsers'
            },
            'H1': {
                description: 'Begin bebouwde kom. Maximumsnelheid 50 km/u tenzij anders aangegeven.',
                article: 'RVV 1990, Artikel 20: Binnen bebouwde kom geldt 50 km/u voor motorvoertuigen'
            },
            'J10': {
                description: 'Waarschuwing voor een overweg met slagbomen. Wacht voor de gesloten slagbomen.',
                article: 'RVV 1990, Artikel 15a: Bij overwegen spoorvoertuigen laten voorgaan'
            },
            'J21': {
                description: 'Let op! Kinderen kunnen hier plotseling de weg oversteken (bijv. bij scholen, speelplaatsen).',
                article: 'RVV 1990: Waarschuwingsbord - extra oplettendheid vereist'
            }
        };

        // Traffic rules quiz questions (NEW)
        const trafficRulesQuestions = [
            {
                type: 'rules',
                question: 'Wat is de maximumsnelheid binnen de bebouwde kom?',
                options: ['30 km/u', '50 km/u', '60 km/u', '80 km/u'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 20: Binnen de bebouwde kom geldt 50 km/u voor motorvoertuigen, tenzij anders aangegeven.'
            },
            {
                type: 'rules',
                question: 'Wat is de maximumsnelheid buiten de bebouwde kom op een gewone weg?',
                options: ['60 km/u', '80 km/u', '100 km/u', '120 km/u'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 21: Buiten de bebouwde kom geldt 80 km/u op gewone wegen.'
            },
            {
                type: 'rules',
                question: 'Wat is de maximumsnelheid op een autosnelweg?',
                options: ['100 km/u', '120 km/u', '130 km/u', '140 km/u'],
                correct: 2,
                explanation: 'RVV 1990 Artikel 21: Op autosnelwegen geldt 130 km/u (tenzij anders aangegeven).'
            },
            {
                type: 'rules',
                question: 'Wat is de maximumsnelheid op een autoweg buiten de bebouwde kom?',
                options: ['80 km/u', '100 km/u', '120 km/u', '130 km/u'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 21: Op autowegen buiten de bebouwde kom geldt 100 km/u.'
            },
            {
                type: 'rules',
                question: 'Op een kruispunt zonder borden: wie heeft voorrang?',
                options: ['Verkeer van links', 'Verkeer van rechts', 'Wie als eerste kwam', 'Snelste voertuig'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 15: Op kruispunten verlenen bestuurders voorrang aan van rechts komende bestuurders.'
            },
            {
                type: 'rules',
                question: 'Wat moet u doen bij een stopbord (B7)?',
                options: ['Vaart minderen', 'Alleen stoppen als er verkeer is', 'Altijd volledig stoppen', 'Doorrijden met voorrang'],
                correct: 2,
                explanation: 'RVV 1990 Artikel 15: Bij bord B7 moet u altijd volledig stoppen, ook als er geen verkeer is.'
            },
            {
                type: 'rules',
                question: 'Welke afstand moet u kunnen overzien om veilig te stoppen?',
                options: ['10 meter', '20 meter', 'Zover als u de weg vrij kunt zien', '100 meter'],
                correct: 2,
                explanation: 'RVV 1990 Artikel 19: De bestuurder moet in staat zijn zijn voertuig tot stilstand te brengen binnen de afstand waarover hij de weg kan overzien en waarover deze vrij is.'
            },
            {
                type: 'rules',
                question: 'Mag u parkeren bij een kruispunt?',
                options: ['Ja, altijd', 'Ja, op minimaal 5 meter afstand', 'Nee, nooit', 'Alleen overdag'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 24: Bij een kruispunt mag u pas parkeren op een afstand van minimaal 5 meter.'
            },
            {
                type: 'rules',
                question: 'Wat is het verschil tussen parkeren en stilstaan?',
                options: ['Geen verschil', 'Stilstaan is korter dan parkeren', 'Parkeren is langer dan in-/uitstappen of laden/lossen', 'Stilstaan mag alleen met motor uit'],
                correct: 2,
                explanation: 'RVV 1990 Artikel 1: Parkeren is langer stilstaan dan de tijd nodig voor in-/uitstappen of laden/lossen.'
            },
            {
                type: 'rules',
                question: 'Waar moeten fietsers rijden?',
                options: ['Altijd op de rijbaan', 'Op het verplichte fietspad of fiets/bromfietspad', 'Waar ze willen', 'Op het trottoir'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 5: Fietsers gebruiken het verplichte fietspad of het fiets/bromfietspad.'
            },
            {
                type: 'rules',
                question: 'Mogen fietsers naast elkaar rijden?',
                options: ['Nee, nooit', 'Ja, met maximaal twee naast elkaar', 'Ja, met maximaal drie naast elkaar', 'Alleen op fietspaden'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 3: Fietsers mogen met zijn twee√´n naast elkaar rijden.'
            },
            {
                type: 'rules',
                question: 'Waar moeten bromfietsers rijden?',
                options: ['Op het fietspad', 'Op de rijbaan', 'Op het fiets/bromfietspad', 'Op het trottoir'],
                correct: 2,
                explanation: 'RVV 1990 Artikel 6: Bromfietsers gebruiken het fiets/bromfietspad.'
            },
            {
                type: 'rules',
                question: 'Wanneer moet u dimlicht voeren op een auto?',
                options: ['Alleen bij nacht', 'Bij dag en nacht', 'Bij slecht zicht en bij nacht', 'Alleen in de winter'],
                correct: 2,
                explanation: 'RVV 1990 Artikel 32: Bij dag indien het zicht ernstig wordt belemmerd, en bij nacht moet dimlicht worden gevoerd.'
            },
            {
                type: 'rules',
                question: 'Mag u een militaire colonne doorsnijden?',
                options: ['Ja, altijd', 'Nee, nooit', 'Alleen bij files', 'Alleen op autowegen'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 16: Weggebruikers mogen militaire colonnes en uitvaartstoeten niet doorsnijden.'
            },
            {
                type: 'rules',
                question: 'Wanneer mag u uw claxon gebruiken?',
                options: ['Om te groeten', 'Bij ergernis', 'Ter afwending van dreigend gevaar', 'Altijd wanneer u wilt'],
                correct: 2,
                explanation: 'RVV 1990 Artikel 28: Bestuurders mogen slechts geluidssignalen geven ter afwending van dreigend gevaar.'
            },
            {
                type: 'rules',
                question: 'Mag u een voertuig inhalen vlak voor een zebrapad?',
                options: ['Ja, als er geen voetgangers zijn', 'Nee, dat is verboden', 'Alleen fietsers', 'Alleen langzaam verkeer'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 12: Het is verboden een voertuig vlak voor of op een voetgangersoversteekplaats in te halen.'
            },
            {
                type: 'rules',
                question: 'Welke maximumsnelheid geldt op een erf?',
                options: ['15 km/u', '30 km/u', '50 km/u', 'Stapvoets (ongeveer 5 km/u)'],
                correct: 0,
                explanation: 'Op een erf (bord G5) geldt stapvoets rijden, wat ongeveer 15 km/u betekent. Voetgangers mogen overal lopen.'
            },
            {
                type: 'rules',
                question: 'Wat moet u doen bij een overweg zonder slagbomen?',
                options: ['Doorrijden zonder stoppen', 'Altijd stoppen', 'Spoorvoertuig laten voorgaan en overweg vrijhouden', 'Claxonneren'],
                correct: 2,
                explanation: 'RVV 1990 Artikel 15a: Bij overwegen laten weggebruikers een spoorvoertuig voorgaan en laten daarbij de overweg geheel vrij.'
            },
            {
                type: 'rules',
                question: 'Mag u dubbel parkeren?',
                options: ['Ja, als het kort is', 'Ja, met motor uit', 'Nee, dat is verboden', 'Alleen met gevaar driehoek'],
                correct: 2,
                explanation: 'RVV 1990 Artikel 24: De bestuurder mag zijn voertuig niet dubbel parkeren.'
            },
            {
                type: 'rules',
                question: 'Hoe moet u afslaan naar links op een kruispunt?',
                options: ['Meteen afslaan', 'Tegemoetkomend verkeer laten voorgaan', 'Claxonneren en dan afslaan', 'Voorrang hebben'],
                correct: 1,
                explanation: 'RVV 1990 Artikel 18: Bestuurders die afslaan moeten verkeer dat tegemoet komt of naast hen is, laten voorgaan.'
            }
        ];

        // Load data from JSON file
        async function loadData() {
            try {
                const response = await fetch('verkeersborden_officieel.json');
                const data = await response.json();

                // Add image URLs to signs data
                allSigns = data.borden.map(sign => ({
                    ...sign,
                    imageUrl: `images/${sign.code}.png`
                }));

                filteredSigns = [...allSigns];

                // Create filter buttons
                createFilterButtons();

                // Display signs
                displaySigns();

                // Update stats
                updateStats();

            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('signsGrid').innerHTML =
                    '<div class="loading">Fout bij laden van data. Controleer of verkeersborden_officieel.json beschikbaar is.</div>';
            }
        }

        // Create filter buttons for categories
        function createFilterButtons() {
            const categories = [...new Set(allSigns.map(sign => sign.hoofdstuk))];
            const filterContainer = document.getElementById('filterButtons');

            categories.forEach(category => {
                const btn = document.createElement('button');
                btn.className = 'filter-btn';
                btn.textContent = category;
                btn.setAttribute('data-filter', category);
                btn.onclick = () => filterByCategory(category);
                filterContainer.appendChild(btn);
            });
        }

        // Filter by category
        function filterByCategory(category) {
            // Update button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Filter signs
            if (category === 'all') {
                filteredSigns = [...allSigns];
            } else {
                filteredSigns = allSigns.filter(sign => sign.hoofdstuk === category);
            }

            // Apply search if active
            const searchTerm = document.getElementById('searchBox').value;
            if (searchTerm) {
                searchSigns(searchTerm);
            } else {
                displaySigns();
            }

            updateStats();
        }

        // Search functionality
        document.getElementById('searchBox').addEventListener('input', (e) => {
            searchSigns(e.target.value);
        });

        function searchSigns(searchTerm) {
            const term = searchTerm.toLowerCase().trim();

            if (term === '') {
                filteredSigns = [...allSigns];
                // Re-apply category filter if active
                const activeFilter = document.querySelector('.filter-btn.active');
                if (activeFilter && activeFilter.dataset.filter !== 'all') {
                    filteredSigns = filteredSigns.filter(sign =>
                        sign.hoofdstuk === activeFilter.dataset.filter
                    );
                }
            } else {
                filteredSigns = allSigns.filter(sign =>
                    sign.code.toLowerCase().includes(term) ||
                    sign.omschrijving.toLowerCase().includes(term) ||
                    sign.hoofdstuk.toLowerCase().includes(term)
                );
            }

            displaySigns();
            updateStats();
        }

        // Display signs in grid with hover tooltips
        function displaySigns() {
            const grid = document.getElementById('signsGrid');

            if (filteredSigns.length === 0) {
                grid.innerHTML = '<div class="loading">Geen verkeersborden gevonden.</div>';
                return;
            }

            grid.innerHTML = filteredSigns.map(sign => `
                <div class="sign-card" onmouseenter="showTooltip(event, '${sign.code}')" onmouseleave="hideTooltip()">
                    <div class="sign-image-container">
                        ${sign.imageUrl ?
                            `<img src="${sign.imageUrl}" alt="${sign.omschrijving}" class="sign-image" onerror="this.parentElement.innerHTML='<div class=\\'no-image\\'>Afbeelding niet beschikbaar</div>'">` :
                            '<div class="no-image">Afbeelding niet beschikbaar</div>'
                        }
                    </div>
                    <div class="sign-code">${sign.code}</div>
                    <div class="sign-title">${sign.omschrijving}</div>
                    <div class="sign-category">${sign.hoofdstuk}</div>
                </div>
            `).join('');
        }

        // Show tooltip with comprehensive explanation
        function showTooltip(event, code) {
            const rect = event.currentTarget.getBoundingClientRect();
            const sign = allSigns.find(s => s.code === code);
            const explanation = signExplanations[code];

            if (!sign) return;

            let tooltipContent = `
                <div class="tooltip-title">${sign.code}: ${sign.omschrijving}</div>
                <div class="tooltip-description">
                    ${explanation ? explanation.description : 'Dit verkeersbord is onderdeel van het officiele RVV 1990 reglement.'}
                </div>
            `;

            if (explanation && explanation.article) {
                tooltipContent += `<div class="tooltip-article">${explanation.article}</div>`;
            }

            tooltip.innerHTML = tooltipContent;
            tooltip.classList.add('show');

            // Position tooltip
            const tooltipRect = tooltip.getBoundingClientRect();
            let left = rect.left + rect.width / 2 - tooltipRect.width / 2;
            let top = rect.top - tooltipRect.height - 10;

            // Keep tooltip on screen
            if (left < 10) left = 10;
            if (left + tooltipRect.width > window.innerWidth - 10) {
                left = window.innerWidth - tooltipRect.width - 10;
            }
            if (top < 10) {
                top = rect.bottom + 10;
            }

            tooltip.style.left = left + 'px';
            tooltip.style.top = top + window.scrollY + 'px';
        }

        function hideTooltip() {
            tooltip.classList.remove('show');
        }

        // Update statistics
        function updateStats() {
            document.getElementById('totalSigns').textContent = allSigns.length;
            document.getElementById('visibleSigns').textContent = filteredSigns.length;
        }

        // Switch between browse and quiz mode
        function switchMode(mode) {
            currentMode = mode;

            // Update button states
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.mode-btn.${mode}`).classList.add('active');

            // Show/hide appropriate content
            if (mode === 'browse') {
                document.getElementById('browseMode').classList.remove('hidden');
                document.getElementById('quizMode').classList.add('hidden');
            } else {
                document.getElementById('browseMode').classList.add('hidden');
                document.getElementById('quizMode').classList.remove('hidden');
                startQuiz();
            }
        }

        // Quiz functionality - ENHANCED with traffic rules
        function startQuiz() {
            // Mix sign recognition and traffic rules questions
            const signsWithImages = allSigns.filter(sign => sign.imageUrl);

            if (signsWithImages.length < 4) {
                alert('Niet genoeg borden met afbeeldingen beschikbaar voor een quiz.');
                return;
            }

            // Select 8 random sign questions
            const shuffledSigns = [...signsWithImages].sort(() => Math.random() - 0.5);
            const signQuestions = shuffledSigns.slice(0, 8).map(sign => ({
                type: 'sign',
                sign: sign
            }));

            // Select 7 random traffic rules questions
            const shuffledRules = [...trafficRulesQuestions].sort(() => Math.random() - 0.5);
            const rulesQuestions = shuffledRules.slice(0, 7);

            // Combine and shuffle all questions
            quizQuestions = [...signQuestions, ...rulesQuestions].sort(() => Math.random() - 0.5);

            currentQuestionIndex = 0;
            quizScore = 0;

            document.getElementById('quizQuestion').classList.remove('hidden');
            document.getElementById('quizResults').classList.add('hidden');

            showQuestion();
        }

        function showQuestion() {
            if (currentQuestionIndex >= quizQuestions.length) {
                showResults();
                return;
            }

            answeredCorrectly = false;
            const currentQuestion = quizQuestions[currentQuestionIndex];

            // Update progress
            document.getElementById('quizCounter').textContent =
                `Vraag ${currentQuestionIndex + 1}/${quizQuestions.length}`;
            document.getElementById('quizScore').textContent =
                `Score: ${quizScore}/${currentQuestionIndex}`;

            const questionText = document.getElementById('questionText');
            const imageContainer = document.getElementById('quizImageContainer');
            const quizImage = document.getElementById('quizImage');

            if (currentQuestion.type === 'sign') {
                // Sign recognition question
                questionText.textContent = 'Wat betekent dit verkeersbord?';
                imageContainer.style.display = 'flex';
                quizImage.src = currentQuestion.sign.imageUrl;

                // Create options
                const options = generateSignOptions(currentQuestion.sign);
                displayOptions(options, currentQuestion.sign.omschrijving);
            } else {
                // Traffic rules question
                questionText.textContent = currentQuestion.question;
                imageContainer.style.display = 'none';

                // Display text options
                displayTextOptions(currentQuestion.options, currentQuestion.correct);
            }

            document.getElementById('quizNextBtn').disabled = true;
        }

        function generateSignOptions(correctSign) {
            const options = [correctSign.omschrijving];
            const otherSigns = allSigns.filter(sign =>
                sign.imageUrl && sign.code !== correctSign.code
            );

            // Add 3 random wrong answers
            const shuffled = [...otherSigns].sort(() => Math.random() - 0.5);
            options.push(...shuffled.slice(0, 3).map(s => s.omschrijving));

            // Shuffle options
            return options.sort(() => Math.random() - 0.5);
        }

        function displayOptions(options, correctAnswer) {
            const optionsContainer = document.getElementById('quizOptions');

            optionsContainer.innerHTML = options.map((option, index) => `
                <button class="quiz-option" onclick="selectSignAnswer(this, '${correctAnswer}')" data-answer="${option}">
                    ${option}
                </button>
            `).join('');
        }

        function displayTextOptions(options, correctIndex) {
            const optionsContainer = document.getElementById('quizOptions');

            optionsContainer.innerHTML = options.map((option, index) => `
                <button class="quiz-option" onclick="selectRulesAnswer(this, ${correctIndex})" data-index="${index}">
                    ${option}
                </button>
            `).join('');
        }

        function selectSignAnswer(element, correctAnswer) {
            const options = document.querySelectorAll('.quiz-option');
            const selectedAnswer = element.getAttribute('data-answer');
            const isCorrect = selectedAnswer === correctAnswer;

            // Disable all options
            options.forEach(opt => {
                opt.classList.add('disabled');
                if (opt.getAttribute('data-answer') === correctAnswer) {
                    opt.classList.add('correct');
                }
            });

            // Mark selected answer
            if (!isCorrect) {
                element.classList.add('incorrect');
            } else if (!answeredCorrectly) {
                quizScore++;
                answeredCorrectly = true;
            }

            // Enable next button
            document.getElementById('quizNextBtn').disabled = false;

            // Update score display
            document.getElementById('quizScore').textContent =
                `Score: ${quizScore}/${currentQuestionIndex + 1}`;
        }

        function selectRulesAnswer(element, correctIndex) {
            const options = document.querySelectorAll('.quiz-option');
            const selectedIndex = parseInt(element.getAttribute('data-index'));
            const isCorrect = selectedIndex === correctIndex;

            // Disable all options
            options.forEach((opt, idx) => {
                opt.classList.add('disabled');
                if (idx === correctIndex) {
                    opt.classList.add('correct');
                }
            });

            // Mark selected answer
            if (!isCorrect) {
                element.classList.add('incorrect');
            } else if (!answeredCorrectly) {
                quizScore++;
                answeredCorrectly = true;
            }

            // Enable next button
            document.getElementById('quizNextBtn').disabled = false;

            // Update score display
            document.getElementById('quizScore').textContent =
                `Score: ${quizScore}/${currentQuestionIndex + 1}`;
        }

        function nextQuestion() {
            currentQuestionIndex++;
            showQuestion();
        }

        function showResults() {
            document.getElementById('quizQuestion').classList.add('hidden');
            document.getElementById('quizResults').classList.remove('hidden');

            const percentage = (quizScore / quizQuestions.length) * 100;
            document.getElementById('finalScore').textContent =
                `${quizScore}/${quizQuestions.length}`;

            let message = '';
            if (percentage >= 90) {
                message = 'Uitstekend! Je bent klaar voor het CBR-theorie-examen!';
            } else if (percentage >= 80) {
                message = 'Zeer goed! Je kent de verkeersregels goed!';
            } else if (percentage >= 70) {
                message = 'Goed gedaan! Blijf oefenen voor een perfecte score!';
            } else if (percentage >= 60) {
                message = 'Redelijk, maar er is ruimte voor verbetering.';
            } else {
                message = 'Blijf oefenen! Lees de verkeersborden en regels nog eens goed door.';
            }

            document.getElementById('resultMessage').textContent = message;
        }

        // Initialize app
        loadData();

        // Hide tooltip on scroll
        window.addEventListener('scroll', hideTooltip);
    </script>
</body>
</html>

        // Theme toggle function
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            const isDark = !document.body.classList.contains('light-theme');
            const toggleBtn = document.querySelector('.theme-toggle');
            if (toggleBtn) {
                toggleBtn.textContent = isDark ? '‚òÄÔ∏è Light' : 'üåô Dark';
            }
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        // Load saved theme on page load
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.body.classList.add('light-theme');
                const toggleBtn = document.querySelector('.theme-toggle');
                if (toggleBtn) toggleBtn.textContent = 'üåô Dark';
            }
        });
